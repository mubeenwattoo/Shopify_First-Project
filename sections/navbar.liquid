
{% assign main_menu_linklists = linklists[section.settings.menu].links %}

<div class="relative bg-white w-full" x-data="{ mobileOpen: false, openDropdown: null }">
  <div class="mx-auto px-4 sm:px-6 w-full">
    <!-- Top bar: logo + menu button (mobile) / nav + cart (desktop) -->
    <div class="flex justify-between items-center py-4 md:py-6">
      <!-- Logo (left) -->
      <div class="shrink-0">
        <a href="{{ routes.root_url }}" class="text-xl font-bold truncate">{{ section.settings.logo-text }}</a>
      </div>

      <!-- Desktop: nav + cart/login (hidden on mobile) -->
      <nav class="hidden md:flex items-center space-x-10">
        {% for link in main_menu_linklists %}
          {% if link.links != blank %}
            <div class="relative">
              <button
                type="button"
                @click="openDropdown = openDropdown === {{ forloop.index0 }} ? null : {{ forloop.index0 }}"
                @click.away="openDropdown = null"
                class="inline-flex items-center text-base text-gray-500 hover:text-gray-900"
              >
                {{ link.title }}
                {% render 'dropdown-icon' %}
              </button>
              <div
                x-show="openDropdown === {{ forloop.index0 }}"
                x-transition
                class="absolute z-10 mt-2 py-1 min-w-[14rem] left-0"
                style="position: absolute; z-index: 50; top: 100%; left: 0; margin-top: 0.5rem;"
              >
                <div class="shadow-lg border overflow-hidden rounded-lg bg-white">
                  <div class="py-2">
                    {% for childlink in link.links %}
                      <a href="{{ childlink.url }}" class="block px-5 py-2 text-gray-900 text-base hover:bg-gray-100">
                        {{ childlink.title }}
                      </a>
                    {% endfor %}
                  </div>
                </div>
              </div>
            </div>
          {% else %}
            <a href="{{ link.url }}" class="text-base text-gray-500 hover:text-gray-900">{{ link.title }}</a>
          {% endif %}
        {% endfor %}
      </nav>

      <!-- Right side: mobile menu button OR desktop cart/login -->
      <div class="flex items-center gap-4">
        <!-- Desktop: cart, login, register -->
        <div class="hidden md:flex items-center space-x-5">
          <a href="{{ routes.cart_url }}" class="text-gray-500 hover:text-gray-900" aria-label="Cart">
            {% render 'shopping-icon' %}
          </a>
          <a href="{{ routes.account_login_url }}" class="text-base text-gray-500 hover:text-gray-900">Login</a>
          <a href="{{ routes.account_register_url }}" class="text-base text-gray-500 hover:text-gray-900">Register</a>
        </div>

        <!-- Mobile: hamburger / close button -->
        <button
          type="button"
          class="md:hidden p-2 text-gray-500 hover:text-gray-900 rounded-lg"
          aria-label="Toggle menu"
          @click="mobileOpen = !mobileOpen; openDropdown = null"
        >
          <!-- Hamburger icon (when closed) -->
          <svg x-show="!mobileOpen" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
          <!-- Close icon (when open) -->
          <svg x-show="mobileOpen" x-cloak class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile menu panel (full width, below header, vertical nav) -->
  <div
    x-show="mobileOpen"
    x-transition
    class="absolute left-0 right-0 top-full z-40 bg-white shadow-lg border-t border-gray-200 max-h-[calc(100vh-5rem)] overflow-y-auto md:hidden"
    style="display: none;"
  >
      <div class="px-4 py-4 space-y-1 border-b border-gray-100">
        {% for link in main_menu_linklists %}
          {% if link.links != blank %}
            <div class="border-b border-gray-100 last:border-0">
              <button
                type="button"
                class="flex items-center justify-between w-full py-4 text-left text-base font-medium text-gray-900"
                @click="openDropdown = openDropdown === {{ forloop.index0 }} ? null : {{ forloop.index0 }}"
              >
                <span>{{ link.title }}</span>
                <svg
                  class="w-5 h-5 text-gray-500 transition-transform"
                  :class="{ 'rotate-180': openDropdown === {{ forloop.index0 }} }"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
              </button>
              <div
                x-show="openDropdown === {{ forloop.index0 }}"
                x-transition
                class="pb-3 pl-4"
              >
                {% for childlink in link.links %}
                  <a
                    href="{{ childlink.url }}"
                    class="block py-2 text-gray-600 hover:text-gray-900"
                    @click="mobileOpen = false"
                  >
                    {{ childlink.title }}
                  </a>
                {% endfor %}
              </div>
            </div>
          {% else %}
            <a
              href="{{ link.url }}"
              class="block py-4 text-base font-medium text-gray-900 border-b border-gray-100 last:border-0"
              @click="mobileOpen = false"
            >
              {{ link.title }}
            </a>
          {% endif %}
        {% endfor %}
      </div>

      <!-- Mobile: cart, login, register -->
      <div class="px-4 py-4 space-y-2 border-t border-gray-200">
        <a href="{{ routes.cart_url }}" class="flex items-center gap-2 py-3 text-gray-700 hover:text-gray-900" @click="mobileOpen = false">
          {% render 'shopping-icon' %}
          <span>Cart</span>
        </a>
        <a href="{{ routes.account_login_url }}" class="block py-3 text-gray-700 hover:text-gray-900" @click="mobileOpen = false">Login</a>
        <a href="{{ routes.account_register_url }}" class="block py-3 text-gray-700 hover:text-gray-900" @click="mobileOpen = false">Register</a>
      </div>
    </div>
  </div>

<style>
  [x-cloak] { display: none !important; }
</style>


{% schema %}
  {
    "name": "Navbar",
    "settings": [
      {
      "type": "text",
      "id": "logo-text",
      "label": "Custom Text",
      "default": "Mubeen Theme",
      "info": "This text will appear as the logo in the navbar. You can also use the shop name by leaving this blank."
      },
      
      {
        "type": "link_list",
        "id": "menu",
        "label": "Navbar Menu",
        "default": "main-menu",
      }
    ]
  }
{% endschema %}